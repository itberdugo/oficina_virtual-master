module.exports = {

"[project]/src/app/layout.tsx (client proxy)": (({ r: __turbopack_require__, f: __turbopack_module_context__, i: __turbopack_import__, s: __turbopack_esm__, v: __turbopack_export_value__, n: __turbopack_export_namespace__, c: __turbopack_cache__, M: __turbopack_modules__, l: __turbopack_load__, j: __turbopack_dynamic__, P: __turbopack_resolve_absolute_path__, U: __turbopack_relative_url__, R: __turbopack_resolve_module_id_path__, g: global, __dirname, x: __turbopack_external_require__, y: __turbopack_external_import__ }) => (() => {
"use strict";

__turbopack_esm__({
    "default": ()=>__TURBOPACK__default__export__
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$future$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$server$2d$dom$2d$turbopack$2d$server$2d$edge$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/node_modules/next/dist/server/future/route-modules/app-page/vendored/rsc/react-server-dom-turbopack-server-edge.js [app-rsc] (ecmascript)");
"__TURBOPACK__ecmascript__hoisting__location__";
;
const __TURBOPACK__default__export__ = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$future$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$server$2d$dom$2d$turbopack$2d$server$2d$edge$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerClientReference"])(function() {
    throw new Error("Attempted to call the default export of [project]/src/app/layout.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.");
}, "[project]/src/app/layout.tsx", "default");

})()),
"[project]/src/app/layout.tsx [app-rsc] (ecmascript)": (({ r: __turbopack_require__, f: __turbopack_module_context__, i: __turbopack_import__, s: __turbopack_esm__, v: __turbopack_export_value__, n: __turbopack_export_namespace__, c: __turbopack_cache__, M: __turbopack_modules__, l: __turbopack_load__, j: __turbopack_dynamic__, P: __turbopack_resolve_absolute_path__, U: __turbopack_relative_url__, R: __turbopack_resolve_module_id_path__, g: global, __dirname, x: __turbopack_external_require__, y: __turbopack_external_import__ }) => (() => {
"use strict";

var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$app$2f$layout$2e$tsx__$28$client__proxy$29$__ = __turbopack_import__("[project]/src/app/layout.tsx (client proxy)");
"__TURBOPACK__ecmascript__hoisting__location__";
"TURBOPACK { transition: next-ecmascript-client-reference }";
;
__turbopack_export_namespace__(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$app$2f$layout$2e$tsx__$28$client__proxy$29$__);

})()),
"[project]/src/app/layout.tsx [app-rsc] (ecmascript, Next.js server component)": (({ r: __turbopack_require__, f: __turbopack_module_context__, i: __turbopack_import__, s: __turbopack_esm__, v: __turbopack_export_value__, n: __turbopack_export_namespace__, c: __turbopack_cache__, M: __turbopack_modules__, l: __turbopack_load__, j: __turbopack_dynamic__, P: __turbopack_resolve_absolute_path__, U: __turbopack_relative_url__, R: __turbopack_resolve_module_id_path__, g: global, __dirname }) => (() => {

__turbopack_esm__({
    default: () => __turbopack_import__("[project]/src/app/layout.tsx [app-rsc] (ecmascript)"),
});

})()),
"[project]/src/app/page.tsx (client proxy)": (({ r: __turbopack_require__, f: __turbopack_module_context__, i: __turbopack_import__, s: __turbopack_esm__, v: __turbopack_export_value__, n: __turbopack_export_namespace__, c: __turbopack_cache__, M: __turbopack_modules__, l: __turbopack_load__, j: __turbopack_dynamic__, P: __turbopack_resolve_absolute_path__, U: __turbopack_relative_url__, R: __turbopack_resolve_module_id_path__, g: global, __dirname, x: __turbopack_external_require__, y: __turbopack_external_import__ }) => (() => {
"use strict";

__turbopack_esm__({
    "default": ()=>__TURBOPACK__default__export__
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$future$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$server$2d$dom$2d$turbopack$2d$server$2d$edge$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/node_modules/next/dist/server/future/route-modules/app-page/vendored/rsc/react-server-dom-turbopack-server-edge.js [app-rsc] (ecmascript)");
"__TURBOPACK__ecmascript__hoisting__location__";
;
const __TURBOPACK__default__export__ = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$future$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$rsc$2f$react$2d$server$2d$dom$2d$turbopack$2d$server$2d$edge$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerClientReference"])(function() {
    throw new Error("Attempted to call the default export of [project]/src/app/page.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.");
}, "[project]/src/app/page.tsx", "default");

})()),
"[project]/src/app/page.tsx [app-rsc] (ecmascript)": (({ r: __turbopack_require__, f: __turbopack_module_context__, i: __turbopack_import__, s: __turbopack_esm__, v: __turbopack_export_value__, n: __turbopack_export_namespace__, c: __turbopack_cache__, M: __turbopack_modules__, l: __turbopack_load__, j: __turbopack_dynamic__, P: __turbopack_resolve_absolute_path__, U: __turbopack_relative_url__, R: __turbopack_resolve_module_id_path__, g: global, __dirname, x: __turbopack_external_require__, y: __turbopack_external_import__ }) => (() => {
"use strict";

var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$app$2f$page$2e$tsx__$28$client__proxy$29$__ = __turbopack_import__("[project]/src/app/page.tsx (client proxy)");
"__TURBOPACK__ecmascript__hoisting__location__";
"TURBOPACK { transition: next-ecmascript-client-reference }";
;
__turbopack_export_namespace__(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$app$2f$page$2e$tsx__$28$client__proxy$29$__);

})()),
"[project]/src/app/page.tsx [app-rsc] (ecmascript, Next.js server component)": (({ r: __turbopack_require__, f: __turbopack_module_context__, i: __turbopack_import__, s: __turbopack_esm__, v: __turbopack_export_value__, n: __turbopack_export_namespace__, c: __turbopack_cache__, M: __turbopack_modules__, l: __turbopack_load__, j: __turbopack_dynamic__, P: __turbopack_resolve_absolute_path__, U: __turbopack_relative_url__, R: __turbopack_resolve_module_id_path__, g: global, __dirname }) => (() => {

__turbopack_esm__({
    default: () => __turbopack_import__("[project]/src/app/page.tsx [app-rsc] (ecmascript)"),
});

})()),
"[project]/src/app/favicon.ico [app-rsc] (static)": (({ r: __turbopack_require__, f: __turbopack_module_context__, i: __turbopack_import__, s: __turbopack_esm__, v: __turbopack_export_value__, n: __turbopack_export_namespace__, c: __turbopack_cache__, M: __turbopack_modules__, l: __turbopack_load__, j: __turbopack_dynamic__, P: __turbopack_resolve_absolute_path__, U: __turbopack_relative_url__, R: __turbopack_resolve_module_id_path__, g: global, __dirname }) => (() => {

__turbopack_export_value__("/_next/static/media/favicon.45db1c09.ico");
})()),
"[project]/src/app/favicon.ico.mjs { IMAGE => \"[project]/src/app/favicon.ico [app-rsc] (static)\" } [app-rsc] (structured image object, ecmascript)": (({ r: __turbopack_require__, f: __turbopack_module_context__, i: __turbopack_import__, s: __turbopack_esm__, v: __turbopack_export_value__, n: __turbopack_export_namespace__, c: __turbopack_cache__, M: __turbopack_modules__, l: __turbopack_load__, j: __turbopack_dynamic__, P: __turbopack_resolve_absolute_path__, U: __turbopack_relative_url__, R: __turbopack_resolve_module_id_path__, g: global, __dirname, x: __turbopack_external_require__, y: __turbopack_external_import__ }) => (() => {
"use strict";

__turbopack_esm__({
    "default": ()=>__TURBOPACK__default__export__
});
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$app$2f$favicon$2e$ico__$5b$app$2d$rsc$5d$__$28$static$29$__ = __turbopack_import__("[project]/src/app/favicon.ico [app-rsc] (static)");
"__TURBOPACK__ecmascript__hoisting__location__";
;
const __TURBOPACK__default__export__ = {
    src: __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$app$2f$favicon$2e$ico__$5b$app$2d$rsc$5d$__$28$static$29$__["default"],
    width: 256,
    height: 256
};

})()),
"[project]/src/utils/helpers.ts [app-rsc] (ecmascript)": (({ r: __turbopack_require__, f: __turbopack_module_context__, i: __turbopack_import__, s: __turbopack_esm__, v: __turbopack_export_value__, n: __turbopack_export_namespace__, c: __turbopack_cache__, M: __turbopack_modules__, l: __turbopack_load__, j: __turbopack_dynamic__, P: __turbopack_resolve_absolute_path__, U: __turbopack_relative_url__, R: __turbopack_resolve_module_id_path__, g: global, __dirname, x: __turbopack_external_require__, y: __turbopack_external_import__ }) => (() => {
"use strict";

/* __next_internal_action_entry_do_not_use__ {"19e5c0dd5dd6703d358a7959cbc8b35b1fdef8c4":"encrypt","3896fb9737893354ca9e9f73eacdb15a089d3690":"decrypt","6052572489830d6ea6a97726ab66a58ff3651447":"encryptALONE","7117306d3bb95dc604709e25da694c71b882d471":"GenerateCode"} */ __turbopack_esm__({
    "GenerateCode": ()=>GenerateCode,
    "decrypt": ()=>decrypt,
    "encrypt": ()=>encrypt,
    "encryptALONE": ()=>encryptALONE
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/server-reference.js [app-rsc] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$app$2d$render$2f$encryption$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/node_modules/next/dist/server/app-render/encryption.js [app-rsc] (ecmascript)");
var __TURBOPACK__commonjs__external__crypto__ = __turbopack_external_require__("crypto", true);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$validate$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-validate.js [app-rsc] (ecmascript)");
"__TURBOPACK__ecmascript__hoisting__location__";
;
;
;
const SCP = process.env.PASSWORD_ENCRYPT_KEY;
async function GenerateCode() {
    return Math.floor(100000 + Math.random() * 900000).toString();
}
async function encryptALONE(text, secretKey) {
    const iv = __TURBOPACK__commonjs__external__crypto__["default"].randomBytes(16); // Vector de inicialización aleatorio
    const cipher = __TURBOPACK__commonjs__external__crypto__["default"].createCipheriv('aes-256-cbc', Buffer.from(secretKey, 'hex'), iv);
    let encrypted = cipher.update(text, 'utf-8', 'hex');
    encrypted += cipher.final('hex');
    return iv.toString('hex') + encrypted;
}
async function encrypt(text, secretKey = SCP) {
    const iv = __TURBOPACK__commonjs__external__crypto__["default"].randomBytes(16); // Vector de inicialización aleatorio
    const cipher = __TURBOPACK__commonjs__external__crypto__["default"].createCipheriv('aes-256-cbc', Buffer.from(secretKey, 'hex'), iv);
    let encrypted = cipher.update(text, 'utf-8', 'hex');
    encrypted += cipher.final('hex');
    return iv.toString('hex') + encrypted;
}
async function decrypt(encryptedText, secretKey) {
    const iv = Buffer.from(encryptedText.slice(0, 32), 'hex'); // Extraer el IV del texto cifrado
    const encryptedData = encryptedText.slice(32); // Datos cifrados sin el IV
    const decipher = __TURBOPACK__commonjs__external__crypto__["default"].createDecipheriv('aes-256-cbc', Buffer.from(secretKey, 'hex'), iv);
    let decrypted = decipher.update(encryptedData, 'hex', 'utf-8');
    decrypted += decipher.final('utf-8');
    return decrypted;
}
;
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$validate$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["ensureServerEntryExports"])([
    GenerateCode,
    encryptALONE,
    encrypt,
    decrypt
]);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("7117306d3bb95dc604709e25da694c71b882d471", GenerateCode);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("6052572489830d6ea6a97726ab66a58ff3651447", encryptALONE);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("19e5c0dd5dd6703d358a7959cbc8b35b1fdef8c4", encrypt);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("3896fb9737893354ca9e9f73eacdb15a089d3690", decrypt);

})()),
"[project]/src/utils/helpers_client.ts [app-rsc] (ecmascript)": (({ r: __turbopack_require__, f: __turbopack_module_context__, i: __turbopack_import__, s: __turbopack_esm__, v: __turbopack_export_value__, n: __turbopack_export_namespace__, c: __turbopack_cache__, M: __turbopack_modules__, l: __turbopack_load__, j: __turbopack_dynamic__, P: __turbopack_resolve_absolute_path__, U: __turbopack_relative_url__, R: __turbopack_resolve_module_id_path__, g: global, __dirname, x: __turbopack_external_require__, y: __turbopack_external_import__ }) => (() => {
"use strict";

__turbopack_esm__({
    "ValidateEmail": ()=>ValidateEmail,
    "ValidateSecurityPassword": ()=>ValidateSecurityPassword,
    "generarContrasena": ()=>generarContrasena,
    "unifiedName": ()=>unifiedName
});
var __TURBOPACK__commonjs__external__crypto__ = __turbopack_external_require__("crypto", true);
"__TURBOPACK__ecmascript__hoisting__location__";
;
function unifiedName(primer_nombre, segundo_nombre, primer_apellido, segundo_apellido) {
    return primer_nombre + ' ' + (segundo_nombre ? segundo_nombre + ' ' : '') + (primer_apellido ? primer_apellido + ' ' : '') + (segundo_apellido ? segundo_apellido : '');
}
function generarContrasena() {
    const simbolos = '!@#$%^&*()_+~`|}{[]:;?><,./-=';
    const numeros = '0123456789';
    const mayusculas = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
    let contrasena = '';
    contrasena += simbolos[__TURBOPACK__commonjs__external__crypto__["default"].randomInt(simbolos.length)];
    contrasena += numeros[__TURBOPACK__commonjs__external__crypto__["default"].randomInt(numeros.length)] + numeros[__TURBOPACK__commonjs__external__crypto__["default"].randomInt(numeros.length)];
    contrasena += mayusculas[__TURBOPACK__commonjs__external__crypto__["default"].randomInt(mayusculas.length)];
    while(contrasena.length < 8){
        const chars = simbolos + numeros + mayusculas;
        contrasena += chars[__TURBOPACK__commonjs__external__crypto__["default"].randomInt(chars.length)];
    }
    // Mezclar los caracteres
    contrasena = contrasena.split('').sort(()=>0.5 - Math.random()).join('');
    return contrasena;
}
function ValidateEmail(mail) {
    const re = /^[A-Z0-9._%+-]+@[A-Z0-9.-]+.[A-Z]{2,4}$/i;
    return re.test(mail);
}
function ValidateSecurityPassword(password) {
    const mensajesError = [];
    // Verificar longitud mínima de 8 caracteres
    if (password.length < 8) {
        mensajesError.push("La contraseña debe tener al menos 8 caracteres.");
    }
    // Verificar al menos un símbolo
    if (!/[!@#$%^&*(),.?":{}|<>]/.test(password)) {
        mensajesError.push("La contraseña debe tener al menos un símbolo.");
    }
    // Verificar al menos dos números
    if ((password.match(/\d/g) || []).length < 2) {
        mensajesError.push("La contraseña debe tener al menos dos números.");
    }
    // Verificar al menos una mayúscula
    if (!/[A-Z]/.test(password)) {
        mensajesError.push("La contraseña debe tener al menos una letra mayúscula.");
    }
    return mensajesError;
}

})()),
"[project]/src/utils/mail.ts [app-rsc] (ecmascript)": (({ r: __turbopack_require__, f: __turbopack_module_context__, i: __turbopack_import__, s: __turbopack_esm__, v: __turbopack_export_value__, n: __turbopack_export_namespace__, c: __turbopack_cache__, M: __turbopack_modules__, l: __turbopack_load__, j: __turbopack_dynamic__, P: __turbopack_resolve_absolute_path__, U: __turbopack_relative_url__, R: __turbopack_resolve_module_id_path__, g: global, __dirname, x: __turbopack_external_require__, y: __turbopack_external_import__ }) => (() => {
"use strict";

/* __next_internal_action_entry_do_not_use__ {"26f84502ecf2ae9b2248bcb64eee0e647e5fdc85":"sendMail"} */ __turbopack_esm__({
    "sendMail": ()=>sendMail
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/server-reference.js [app-rsc] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$app$2d$render$2f$encryption$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/node_modules/next/dist/server/app-render/encryption.js [app-rsc] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$nodemailer$2f$lib$2f$nodemailer$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/node_modules/nodemailer/lib/nodemailer.js [app-rsc] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$validate$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-validate.js [app-rsc] (ecmascript)");
"__TURBOPACK__ecmascript__hoisting__location__";
;
;
;
async function sendMail(to, subject, text) {
    try {
        const transporter = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$nodemailer$2f$lib$2f$nodemailer$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["default"].createTransport({
            host: "smtp-mail.outlook.com",
            port: 587,
            secure: false,
            auth: {
                user: process.env.EMAIL_USER,
                pass: process.env.EMAIL_PASS
            }
        });
        await transporter.sendMail({
            from: process.env.EMAIL_USER,
            to,
            subject,
            text
        });
        return true;
    } catch (e) {
        console.log(e);
        return false;
    }
}
;
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$validate$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["ensureServerEntryExports"])([
    sendMail
]);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("26f84502ecf2ae9b2248bcb64eee0e647e5fdc85", sendMail);

})()),
"[project]/src/utils/mongo.ts [app-rsc] (ecmascript)": (({ r: __turbopack_require__, f: __turbopack_module_context__, i: __turbopack_import__, s: __turbopack_esm__, v: __turbopack_export_value__, n: __turbopack_export_namespace__, c: __turbopack_cache__, M: __turbopack_modules__, l: __turbopack_load__, j: __turbopack_dynamic__, P: __turbopack_resolve_absolute_path__, U: __turbopack_relative_url__, R: __turbopack_resolve_module_id_path__, g: global, __dirname, x: __turbopack_external_require__, y: __turbopack_external_import__ }) => (() => {
"use strict";

/* __next_internal_action_entry_do_not_use__ {"1c4ce6e1548761242e0fc4080406954d09629907":"LoginUserDB","21b92e784e69cc96106fa221a2c2a85c93c744ee":"getUserRegisterByMail","2a4aa52ec04bad5bd7a7d951faf47f9e2a98e0ab":"getUserRegisterByDocumento","3de689509e1bc4152490c760ec9cdbe27c91e2ac":"GetTempCode","56a8884c72c058ad262e0bb322a3dbf3b422438b":"setNewPasswordByDocumento","787acc2bd299c33697dbaa34943fc5c1db810b16":"SetNewPassword","858904be9ee2459af8f4ab08246d2f8bc3b023c0":"getMailExists","9ea85d00ae5d7c033b3cde1c1955b906c1b2cb29":"getUserExists","bb3970afdd6be7ab38da4019fe6adad6cf155b6b":"saveUserDB","c7d345923671196f5950e89bd6745978b3cd83a1":"getDocumentoByEmail","ccce0b7f68ddc897ec5092bc8257a234eb35766b":"InsertTempCode","dc9d6386a27158e86c2b69f54bb698c2d0ae65f4":"getMailByDocumento"} */ __turbopack_esm__({
    "GetTempCode": ()=>GetTempCode,
    "InsertTempCode": ()=>InsertTempCode,
    "LoginUserDB": ()=>LoginUserDB,
    "SetNewPassword": ()=>SetNewPassword,
    "getDocumentoByEmail": ()=>getDocumentoByEmail,
    "getMailByDocumento": ()=>getMailByDocumento,
    "getMailExists": ()=>getMailExists,
    "getUserExists": ()=>getUserExists,
    "getUserRegisterByDocumento": ()=>getUserRegisterByDocumento,
    "getUserRegisterByMail": ()=>getUserRegisterByMail,
    "saveUserDB": ()=>saveUserDB,
    "setNewPasswordByDocumento": ()=>setNewPasswordByDocumento
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/server-reference.js [app-rsc] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$app$2d$render$2f$encryption$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/node_modules/next/dist/server/app-render/encryption.js [app-rsc] (ecmascript)");
var __TURBOPACK__commonjs__external__mongodb__ = __turbopack_external_require__("mongodb", true);
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$helpers$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/src/utils/helpers.ts [app-rsc] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$validate$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-validate.js [app-rsc] (ecmascript)");
"__TURBOPACK__ecmascript__hoisting__location__";
;
;
;
;
async function InsertTempCode(documento, email, code) {
    const client = new __TURBOPACK__commonjs__external__mongodb__["MongoClient"](process.env.MONGO_URI || '');
    try {
        await client.connect();
        const db = client.db('oficina_virtual');
        const collection = db.collection('mfa');
        //se elimina el documento si ya existe
        await collection.deleteMany({
            documento
        });
        await collection.insertOne({
            documento,
            code,
            email,
            createAt: new Date()
        });
        return true;
    } catch (e) {
        console.log(e);
        return false;
    } finally{
        await client.close();
    }
}
async function GetTempCode(documento) {
    const client = new __TURBOPACK__commonjs__external__mongodb__["MongoClient"](process.env.MONGO_URI || '');
    try {
        await client.connect();
        const db = client.db('oficina_virtual');
        const collection = db.collection('mfa');
        const res = await collection.findOne({
            documento
        }, {
            projection: {
                _id: 0
            }
        });
        return res ? res : null;
    } catch (e) {
        console.log(e);
        return null;
    } finally{
        await client.close();
    }
}
async function saveUserDB(data) {
    const client = new __TURBOPACK__commonjs__external__mongodb__["MongoClient"](process.env.MONGO_URI || '');
    try {
        await client.connect();
        const db = client.db('oficina_virtual');
        const collection = db.collection('usuarios');
        await collection.insertOne({
            ...data,
            password: await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$helpers$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["encrypt"])(data.password, process.env.PASSWORD_ENCRYPT_KEY || '')
        });
        return true;
    } catch (e) {
        console.log(e);
        return false;
    } finally{
        await client.close();
    }
}
async function getUserExists(documento) {
    const client = new __TURBOPACK__commonjs__external__mongodb__["MongoClient"](process.env.MONGO_URI || '');
    try {
        await client.connect();
        const db = client.db('oficina_virtual');
        const collection = db.collection('usuarios');
        const res = await collection.findOne({
            documento: Number(documento)
        }, {
            projection: {
                _id: 0
            }
        });
        return res ? true : false;
    } catch (e) {
        console.log(e);
        return true;
    } finally{
        await client.close();
    }
}
async function getMailExists(email) {
    const client = new __TURBOPACK__commonjs__external__mongodb__["MongoClient"](process.env.MONGO_URI || '');
    try {
        await client.connect();
        const db = client.db('oficina_virtual');
        const collection = db.collection('usuarios');
        const res = await collection.findOne({
            correo: email
        }, {
            projection: {
                _id: 0
            }
        });
        return res ? true : false;
    } catch (e) {
        console.log(e);
        return true;
    } finally{
        await client.close();
    }
}
async function LoginUserDB(documento, password) {
    const client = new __TURBOPACK__commonjs__external__mongodb__["MongoClient"](process.env.MONGO_URI || '');
    try {
        await client.connect();
        const db = client.db('oficina_virtual');
        const collection = db.collection('usuarios');
        const projection = {
            projection: {
                _id: 0,
                primer_nombre: 1,
                segundo_nombre: 1,
                primer_apellido: 1,
                segundo_apellido: 1,
                correo: 1,
                documento: 1,
                eps: 1,
                password: 1
            }
        };
        const res = await collection.findOne({
            documento: Number(documento)
        }, projection);
        console.log('resultado:', res);
        if (!res) return null;
        const decrypted = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$helpers$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["decrypt"])(res.password, process.env.PASSWORD_ENCRYPT_KEY || '');
        console.log('decrypted:', decrypted);
        if (decrypted !== password) return null;
        return res;
    } catch (e) {
        console.log(e);
        return null;
    } finally{
        await client.close();
    }
}
async function getDocumentoByEmail(email) {
    const client = new __TURBOPACK__commonjs__external__mongodb__["MongoClient"](process.env.MONGO_URI || '');
    try {
        await client.connect();
        const db = client.db('oficina_virtual');
        const collection = db.collection('usuarios');
        const res = await collection.findOne({
            correo: email
        }, {
            projection: {
                _id: 0,
                documento: 1
            }
        });
        return res ? res.documento : null;
    } catch (e) {
        console.log(e);
        return null;
    } finally{
        await client.close();
    }
}
async function getMailByDocumento(documento) {
    const client = new __TURBOPACK__commonjs__external__mongodb__["MongoClient"](process.env.MONGO_URI || '');
    try {
        await client.connect();
        const db = client.db('oficina_virtual');
        const collection = db.collection('usuarios');
        const res = await collection.findOne({
            documento: Number(documento)
        }, {
            projection: {
                _id: 0,
                correo: 1
            }
        });
        return res ? res.correo : null;
    } catch (e) {
        console.log(e);
        return null;
    } finally{
        await client.close();
    }
}
async function SetNewPassword(documento, password) {
    const client = new __TURBOPACK__commonjs__external__mongodb__["MongoClient"](process.env.MONGO_URI || '');
    try {
        await client.connect();
        const db = client.db('oficina_virtual');
        const collection = db.collection('usuarios');
        await collection.updateOne({
            documento: Number(documento)
        }, {
            $set: {
                password: await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$helpers$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["encrypt"])(password, process.env.PASSWORD_ENCRYPT_KEY || '')
            }
        });
        return true;
    } catch (e) {
        console.log(e);
        return false;
    } finally{
        await client.close();
    }
}
async function getUserRegisterByMail(email) {
    const client = new __TURBOPACK__commonjs__external__mongodb__["MongoClient"](process.env.MONGO_URI || '');
    try {
        await client.connect();
        const db = client.db('oficina_virtual');
        const collection = db.collection('usuarios');
        const res = await collection.findOne({
            correo: email
        }, {
            projection: {
                _id: 0,
                iat: 0,
                password: 0
            }
        });
        return res ? res : null;
    } catch (e) {
        console.log(e);
        return null;
    } finally{
        await client.close();
    }
}
async function getUserRegisterByDocumento(documento) {
    const client = new __TURBOPACK__commonjs__external__mongodb__["MongoClient"](process.env.MONGO_URI || '');
    try {
        await client.connect();
        const db = client.db('oficina_virtual');
        const collection = db.collection('usuarios');
        const res = await collection.findOne({
            documento: Number(documento)
        }, {
            projection: {
                _id: 0,
                iat: 0,
                password: 0
            }
        });
        return res ? res : null;
    } catch (e) {
        console.log(e);
        return null;
    } finally{
        await client.close();
    }
}
async function setNewPasswordByDocumento(documento, password) {
    const client = new __TURBOPACK__commonjs__external__mongodb__["MongoClient"](process.env.MONGO_URI || '');
    try {
        await client.connect();
        const db = client.db('oficina_virtual');
        const collection = db.collection('usuarios');
        await collection.updateOne({
            documento: Number(documento)
        }, {
            $set: {
                password: await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$helpers$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["encrypt"])(password, process.env.PASSWORD_ENCRYPT_KEY || '')
            }
        });
        return true;
    } catch (e) {
        console.log(e);
        return false;
    } finally{
        await client.close();
    }
}
;
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$validate$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["ensureServerEntryExports"])([
    InsertTempCode,
    GetTempCode,
    saveUserDB,
    getUserExists,
    getMailExists,
    LoginUserDB,
    getDocumentoByEmail,
    getMailByDocumento,
    SetNewPassword,
    getUserRegisterByMail,
    getUserRegisterByDocumento,
    setNewPasswordByDocumento
]);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("ccce0b7f68ddc897ec5092bc8257a234eb35766b", InsertTempCode);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("3de689509e1bc4152490c760ec9cdbe27c91e2ac", GetTempCode);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("bb3970afdd6be7ab38da4019fe6adad6cf155b6b", saveUserDB);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("9ea85d00ae5d7c033b3cde1c1955b906c1b2cb29", getUserExists);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("858904be9ee2459af8f4ab08246d2f8bc3b023c0", getMailExists);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("1c4ce6e1548761242e0fc4080406954d09629907", LoginUserDB);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("c7d345923671196f5950e89bd6745978b3cd83a1", getDocumentoByEmail);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("dc9d6386a27158e86c2b69f54bb698c2d0ae65f4", getMailByDocumento);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("787acc2bd299c33697dbaa34943fc5c1db810b16", SetNewPassword);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("21b92e784e69cc96106fa221a2c2a85c93c744ee", getUserRegisterByMail);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("2a4aa52ec04bad5bd7a7d951faf47f9e2a98e0ab", getUserRegisterByDocumento);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("56a8884c72c058ad262e0bb322a3dbf3b422438b", setNewPasswordByDocumento);

})()),
"[project]/src/server/login.ts [app-rsc] (ecmascript, action, ecmascript)": (({ r: __turbopack_require__, f: __turbopack_module_context__, i: __turbopack_import__, s: __turbopack_esm__, v: __turbopack_export_value__, n: __turbopack_export_namespace__, c: __turbopack_cache__, M: __turbopack_modules__, l: __turbopack_load__, j: __turbopack_dynamic__, P: __turbopack_resolve_absolute_path__, U: __turbopack_relative_url__, R: __turbopack_resolve_module_id_path__, g: global, __dirname, x: __turbopack_external_require__, y: __turbopack_external_import__ }) => (() => {
"use strict";

/* __next_internal_action_entry_do_not_use__ {"08f302e750b321d0925fa0bc9f4a0bc2d504a6c6":"ValidateCodeDB","2cbbb32563e51c2c38c64e184eb290cc223b643d":"ResetRandomPassword","b4332f6f58871d110c10aa9dc6088593a04593f3":"ValidateCredentialsDB","c6242bc9cf3ceffcdae35466461d0eef73f1c745":"GenerateAndSendCode"} */ __turbopack_esm__({
    "GenerateAndSendCode": ()=>GenerateAndSendCode,
    "ResetRandomPassword": ()=>ResetRandomPassword,
    "ValidateCodeDB": ()=>ValidateCodeDB,
    "ValidateCredentialsDB": ()=>ValidateCredentialsDB
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/server-reference.js [app-rsc] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$app$2d$render$2f$encryption$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/node_modules/next/dist/server/app-render/encryption.js [app-rsc] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$helpers$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/src/utils/helpers.ts [app-rsc] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$helpers_client$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/src/utils/helpers_client.ts [app-rsc] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$mail$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/src/utils/mail.ts [app-rsc] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$mongo$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/src/utils/mongo.ts [app-rsc] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$validate$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-validate.js [app-rsc] (ecmascript)");
"__TURBOPACK__ecmascript__hoisting__location__";
;
;
;
;
;
;
async function GenerateAndSendCode(documento, mail) {
    const code = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$helpers$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["GenerateCode"])();
    const res = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$mongo$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["InsertTempCode"])(documento, mail, code);
    if (!res) return false;
    const res2 = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$mail$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["sendMail"])(mail, 'Codigo de Verificación', `Su codigo de verificación para la creación de su usuario en la plataforma de Hestia oficina virtual es: ${code}`);
    if (!res2) return false;
    return true;
}
async function ValidateCodeDB(documento, code) {
    const res = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$mongo$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["GetTempCode"])(documento);
    if (!res) return {
        status: false,
        message: 'El tiempo para ingresar el código ha expirado, intente nuevamente'
    };
    if (res.code !== code) return {
        status: false,
        message: 'El código no es válido'
    };
    return {
        status: true,
        message: 'Código válido'
    };
}
async function ValidateCredentialsDB(username, password) {
    const decrypted = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$helpers$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["decrypt"])(password, process.env.PASSWORD_ENCRYPT_KEY || '');
    const user = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$mongo$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["LoginUserDB"])(username, decrypted);
    if (!user) return {
        status: false,
        message: 'Usuario o contraseña incorrectos'
    };
    return {
        status: true,
        message: 'Credenciales válidas'
    };
}
async function ResetRandomPassword(documento) {
    const newPassword = (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$helpers_client$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["generarContrasena"])();
    const res = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$mongo$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["SetNewPassword"])(documento, newPassword);
    const mail = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$mongo$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["getMailByDocumento"])(documento);
    if (!mail) return false;
    const res2 = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$mail$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["sendMail"])(mail, 'Nueva Contraseña Temporal Plataforma Hestia', `Su nueva contraseña para la plataforma de Hestia oficina virtual es: ${newPassword}`);
    return res2;
}
;
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$validate$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["ensureServerEntryExports"])([
    GenerateAndSendCode,
    ValidateCodeDB,
    ValidateCredentialsDB,
    ResetRandomPassword
]);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("c6242bc9cf3ceffcdae35466461d0eef73f1c745", GenerateAndSendCode);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("08f302e750b321d0925fa0bc9f4a0bc2d504a6c6", ValidateCodeDB);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("b4332f6f58871d110c10aa9dc6088593a04593f3", ValidateCredentialsDB);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("2cbbb32563e51c2c38c64e184eb290cc223b643d", ResetRandomPassword);

})()),
"[project]/src/utils/helpers.ts [app-rsc] (ecmascript, action, ecmascript)": (({ r: __turbopack_require__, f: __turbopack_module_context__, i: __turbopack_import__, s: __turbopack_esm__, v: __turbopack_export_value__, n: __turbopack_export_namespace__, c: __turbopack_cache__, M: __turbopack_modules__, l: __turbopack_load__, j: __turbopack_dynamic__, P: __turbopack_resolve_absolute_path__, U: __turbopack_relative_url__, R: __turbopack_resolve_module_id_path__, g: global, __dirname, x: __turbopack_external_require__, y: __turbopack_external_import__ }) => (() => {
"use strict";

/* __next_internal_action_entry_do_not_use__ {"19e5c0dd5dd6703d358a7959cbc8b35b1fdef8c4":"encrypt","3896fb9737893354ca9e9f73eacdb15a089d3690":"decrypt","6052572489830d6ea6a97726ab66a58ff3651447":"encryptALONE","7117306d3bb95dc604709e25da694c71b882d471":"GenerateCode"} */ __turbopack_esm__({
    "GenerateCode": ()=>GenerateCode,
    "decrypt": ()=>decrypt,
    "encrypt": ()=>encrypt,
    "encryptALONE": ()=>encryptALONE
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/server-reference.js [app-rsc] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$app$2d$render$2f$encryption$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/node_modules/next/dist/server/app-render/encryption.js [app-rsc] (ecmascript)");
var __TURBOPACK__commonjs__external__crypto__ = __turbopack_external_require__("crypto", true);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$validate$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-validate.js [app-rsc] (ecmascript)");
"__TURBOPACK__ecmascript__hoisting__location__";
;
;
;
const SCP = process.env.PASSWORD_ENCRYPT_KEY;
async function GenerateCode() {
    return Math.floor(100000 + Math.random() * 900000).toString();
}
async function encryptALONE(text, secretKey) {
    const iv = __TURBOPACK__commonjs__external__crypto__["default"].randomBytes(16); // Vector de inicialización aleatorio
    const cipher = __TURBOPACK__commonjs__external__crypto__["default"].createCipheriv('aes-256-cbc', Buffer.from(secretKey, 'hex'), iv);
    let encrypted = cipher.update(text, 'utf-8', 'hex');
    encrypted += cipher.final('hex');
    return iv.toString('hex') + encrypted;
}
async function encrypt(text, secretKey = SCP) {
    const iv = __TURBOPACK__commonjs__external__crypto__["default"].randomBytes(16); // Vector de inicialización aleatorio
    const cipher = __TURBOPACK__commonjs__external__crypto__["default"].createCipheriv('aes-256-cbc', Buffer.from(secretKey, 'hex'), iv);
    let encrypted = cipher.update(text, 'utf-8', 'hex');
    encrypted += cipher.final('hex');
    return iv.toString('hex') + encrypted;
}
async function decrypt(encryptedText, secretKey) {
    const iv = Buffer.from(encryptedText.slice(0, 32), 'hex'); // Extraer el IV del texto cifrado
    const encryptedData = encryptedText.slice(32); // Datos cifrados sin el IV
    const decipher = __TURBOPACK__commonjs__external__crypto__["default"].createDecipheriv('aes-256-cbc', Buffer.from(secretKey, 'hex'), iv);
    let decrypted = decipher.update(encryptedData, 'hex', 'utf-8');
    decrypted += decipher.final('utf-8');
    return decrypted;
}
;
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$validate$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["ensureServerEntryExports"])([
    GenerateCode,
    encryptALONE,
    encrypt,
    decrypt
]);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("7117306d3bb95dc604709e25da694c71b882d471", GenerateCode);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("6052572489830d6ea6a97726ab66a58ff3651447", encryptALONE);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("19e5c0dd5dd6703d358a7959cbc8b35b1fdef8c4", encrypt);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("3896fb9737893354ca9e9f73eacdb15a089d3690", decrypt);

})()),
"[project]/src/utils/mongo.ts [app-rsc] (ecmascript, action, ecmascript)": (({ r: __turbopack_require__, f: __turbopack_module_context__, i: __turbopack_import__, s: __turbopack_esm__, v: __turbopack_export_value__, n: __turbopack_export_namespace__, c: __turbopack_cache__, M: __turbopack_modules__, l: __turbopack_load__, j: __turbopack_dynamic__, P: __turbopack_resolve_absolute_path__, U: __turbopack_relative_url__, R: __turbopack_resolve_module_id_path__, g: global, __dirname, x: __turbopack_external_require__, y: __turbopack_external_import__ }) => (() => {
"use strict";

/* __next_internal_action_entry_do_not_use__ {"1c4ce6e1548761242e0fc4080406954d09629907":"LoginUserDB","21b92e784e69cc96106fa221a2c2a85c93c744ee":"getUserRegisterByMail","2a4aa52ec04bad5bd7a7d951faf47f9e2a98e0ab":"getUserRegisterByDocumento","3de689509e1bc4152490c760ec9cdbe27c91e2ac":"GetTempCode","56a8884c72c058ad262e0bb322a3dbf3b422438b":"setNewPasswordByDocumento","787acc2bd299c33697dbaa34943fc5c1db810b16":"SetNewPassword","858904be9ee2459af8f4ab08246d2f8bc3b023c0":"getMailExists","9ea85d00ae5d7c033b3cde1c1955b906c1b2cb29":"getUserExists","bb3970afdd6be7ab38da4019fe6adad6cf155b6b":"saveUserDB","c7d345923671196f5950e89bd6745978b3cd83a1":"getDocumentoByEmail","ccce0b7f68ddc897ec5092bc8257a234eb35766b":"InsertTempCode","dc9d6386a27158e86c2b69f54bb698c2d0ae65f4":"getMailByDocumento"} */ __turbopack_esm__({
    "GetTempCode": ()=>GetTempCode,
    "InsertTempCode": ()=>InsertTempCode,
    "LoginUserDB": ()=>LoginUserDB,
    "SetNewPassword": ()=>SetNewPassword,
    "getDocumentoByEmail": ()=>getDocumentoByEmail,
    "getMailByDocumento": ()=>getMailByDocumento,
    "getMailExists": ()=>getMailExists,
    "getUserExists": ()=>getUserExists,
    "getUserRegisterByDocumento": ()=>getUserRegisterByDocumento,
    "getUserRegisterByMail": ()=>getUserRegisterByMail,
    "saveUserDB": ()=>saveUserDB,
    "setNewPasswordByDocumento": ()=>setNewPasswordByDocumento
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/server-reference.js [app-rsc] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$app$2d$render$2f$encryption$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/node_modules/next/dist/server/app-render/encryption.js [app-rsc] (ecmascript)");
var __TURBOPACK__commonjs__external__mongodb__ = __turbopack_external_require__("mongodb", true);
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$helpers$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/src/utils/helpers.ts [app-rsc] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$validate$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-validate.js [app-rsc] (ecmascript)");
"__TURBOPACK__ecmascript__hoisting__location__";
;
;
;
;
async function InsertTempCode(documento, email, code) {
    const client = new __TURBOPACK__commonjs__external__mongodb__["MongoClient"](process.env.MONGO_URI || '');
    try {
        await client.connect();
        const db = client.db('oficina_virtual');
        const collection = db.collection('mfa');
        //se elimina el documento si ya existe
        await collection.deleteMany({
            documento
        });
        await collection.insertOne({
            documento,
            code,
            email,
            createAt: new Date()
        });
        return true;
    } catch (e) {
        console.log(e);
        return false;
    } finally{
        await client.close();
    }
}
async function GetTempCode(documento) {
    const client = new __TURBOPACK__commonjs__external__mongodb__["MongoClient"](process.env.MONGO_URI || '');
    try {
        await client.connect();
        const db = client.db('oficina_virtual');
        const collection = db.collection('mfa');
        const res = await collection.findOne({
            documento
        }, {
            projection: {
                _id: 0
            }
        });
        return res ? res : null;
    } catch (e) {
        console.log(e);
        return null;
    } finally{
        await client.close();
    }
}
async function saveUserDB(data) {
    const client = new __TURBOPACK__commonjs__external__mongodb__["MongoClient"](process.env.MONGO_URI || '');
    try {
        await client.connect();
        const db = client.db('oficina_virtual');
        const collection = db.collection('usuarios');
        await collection.insertOne({
            ...data,
            password: await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$helpers$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["encrypt"])(data.password, process.env.PASSWORD_ENCRYPT_KEY || '')
        });
        return true;
    } catch (e) {
        console.log(e);
        return false;
    } finally{
        await client.close();
    }
}
async function getUserExists(documento) {
    const client = new __TURBOPACK__commonjs__external__mongodb__["MongoClient"](process.env.MONGO_URI || '');
    try {
        await client.connect();
        const db = client.db('oficina_virtual');
        const collection = db.collection('usuarios');
        const res = await collection.findOne({
            documento: Number(documento)
        }, {
            projection: {
                _id: 0
            }
        });
        return res ? true : false;
    } catch (e) {
        console.log(e);
        return true;
    } finally{
        await client.close();
    }
}
async function getMailExists(email) {
    const client = new __TURBOPACK__commonjs__external__mongodb__["MongoClient"](process.env.MONGO_URI || '');
    try {
        await client.connect();
        const db = client.db('oficina_virtual');
        const collection = db.collection('usuarios');
        const res = await collection.findOne({
            correo: email
        }, {
            projection: {
                _id: 0
            }
        });
        return res ? true : false;
    } catch (e) {
        console.log(e);
        return true;
    } finally{
        await client.close();
    }
}
async function LoginUserDB(documento, password) {
    const client = new __TURBOPACK__commonjs__external__mongodb__["MongoClient"](process.env.MONGO_URI || '');
    try {
        await client.connect();
        const db = client.db('oficina_virtual');
        const collection = db.collection('usuarios');
        const projection = {
            projection: {
                _id: 0,
                primer_nombre: 1,
                segundo_nombre: 1,
                primer_apellido: 1,
                segundo_apellido: 1,
                correo: 1,
                documento: 1,
                eps: 1,
                password: 1
            }
        };
        const res = await collection.findOne({
            documento: Number(documento)
        }, projection);
        console.log('resultado:', res);
        if (!res) return null;
        const decrypted = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$helpers$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["decrypt"])(res.password, process.env.PASSWORD_ENCRYPT_KEY || '');
        console.log('decrypted:', decrypted);
        if (decrypted !== password) return null;
        return res;
    } catch (e) {
        console.log(e);
        return null;
    } finally{
        await client.close();
    }
}
async function getDocumentoByEmail(email) {
    const client = new __TURBOPACK__commonjs__external__mongodb__["MongoClient"](process.env.MONGO_URI || '');
    try {
        await client.connect();
        const db = client.db('oficina_virtual');
        const collection = db.collection('usuarios');
        const res = await collection.findOne({
            correo: email
        }, {
            projection: {
                _id: 0,
                documento: 1
            }
        });
        return res ? res.documento : null;
    } catch (e) {
        console.log(e);
        return null;
    } finally{
        await client.close();
    }
}
async function getMailByDocumento(documento) {
    const client = new __TURBOPACK__commonjs__external__mongodb__["MongoClient"](process.env.MONGO_URI || '');
    try {
        await client.connect();
        const db = client.db('oficina_virtual');
        const collection = db.collection('usuarios');
        const res = await collection.findOne({
            documento: Number(documento)
        }, {
            projection: {
                _id: 0,
                correo: 1
            }
        });
        return res ? res.correo : null;
    } catch (e) {
        console.log(e);
        return null;
    } finally{
        await client.close();
    }
}
async function SetNewPassword(documento, password) {
    const client = new __TURBOPACK__commonjs__external__mongodb__["MongoClient"](process.env.MONGO_URI || '');
    try {
        await client.connect();
        const db = client.db('oficina_virtual');
        const collection = db.collection('usuarios');
        await collection.updateOne({
            documento: Number(documento)
        }, {
            $set: {
                password: await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$helpers$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["encrypt"])(password, process.env.PASSWORD_ENCRYPT_KEY || '')
            }
        });
        return true;
    } catch (e) {
        console.log(e);
        return false;
    } finally{
        await client.close();
    }
}
async function getUserRegisterByMail(email) {
    const client = new __TURBOPACK__commonjs__external__mongodb__["MongoClient"](process.env.MONGO_URI || '');
    try {
        await client.connect();
        const db = client.db('oficina_virtual');
        const collection = db.collection('usuarios');
        const res = await collection.findOne({
            correo: email
        }, {
            projection: {
                _id: 0,
                iat: 0,
                password: 0
            }
        });
        return res ? res : null;
    } catch (e) {
        console.log(e);
        return null;
    } finally{
        await client.close();
    }
}
async function getUserRegisterByDocumento(documento) {
    const client = new __TURBOPACK__commonjs__external__mongodb__["MongoClient"](process.env.MONGO_URI || '');
    try {
        await client.connect();
        const db = client.db('oficina_virtual');
        const collection = db.collection('usuarios');
        const res = await collection.findOne({
            documento: Number(documento)
        }, {
            projection: {
                _id: 0,
                iat: 0,
                password: 0
            }
        });
        return res ? res : null;
    } catch (e) {
        console.log(e);
        return null;
    } finally{
        await client.close();
    }
}
async function setNewPasswordByDocumento(documento, password) {
    const client = new __TURBOPACK__commonjs__external__mongodb__["MongoClient"](process.env.MONGO_URI || '');
    try {
        await client.connect();
        const db = client.db('oficina_virtual');
        const collection = db.collection('usuarios');
        await collection.updateOne({
            documento: Number(documento)
        }, {
            $set: {
                password: await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$helpers$2e$ts__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["encrypt"])(password, process.env.PASSWORD_ENCRYPT_KEY || '')
            }
        });
        return true;
    } catch (e) {
        console.log(e);
        return false;
    } finally{
        await client.close();
    }
}
;
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$validate$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["ensureServerEntryExports"])([
    InsertTempCode,
    GetTempCode,
    saveUserDB,
    getUserExists,
    getMailExists,
    LoginUserDB,
    getDocumentoByEmail,
    getMailByDocumento,
    SetNewPassword,
    getUserRegisterByMail,
    getUserRegisterByDocumento,
    setNewPasswordByDocumento
]);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("ccce0b7f68ddc897ec5092bc8257a234eb35766b", InsertTempCode);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("3de689509e1bc4152490c760ec9cdbe27c91e2ac", GetTempCode);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("bb3970afdd6be7ab38da4019fe6adad6cf155b6b", saveUserDB);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("9ea85d00ae5d7c033b3cde1c1955b906c1b2cb29", getUserExists);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("858904be9ee2459af8f4ab08246d2f8bc3b023c0", getMailExists);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("1c4ce6e1548761242e0fc4080406954d09629907", LoginUserDB);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("c7d345923671196f5950e89bd6745978b3cd83a1", getDocumentoByEmail);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("dc9d6386a27158e86c2b69f54bb698c2d0ae65f4", getMailByDocumento);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("787acc2bd299c33697dbaa34943fc5c1db810b16", SetNewPassword);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("21b92e784e69cc96106fa221a2c2a85c93c744ee", getUserRegisterByMail);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("2a4aa52ec04bad5bd7a7d951faf47f9e2a98e0ab", getUserRegisterByDocumento);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("56a8884c72c058ad262e0bb322a3dbf3b422438b", setNewPasswordByDocumento);

})()),
"[project]/src/utils/http.ts [app-rsc] (ecmascript, action, ecmascript)": (({ r: __turbopack_require__, f: __turbopack_module_context__, i: __turbopack_import__, s: __turbopack_esm__, v: __turbopack_export_value__, n: __turbopack_export_namespace__, c: __turbopack_cache__, M: __turbopack_modules__, l: __turbopack_load__, j: __turbopack_dynamic__, P: __turbopack_resolve_absolute_path__, U: __turbopack_relative_url__, R: __turbopack_resolve_module_id_path__, g: global, __dirname, x: __turbopack_external_require__, y: __turbopack_external_import__ }) => (() => {
"use strict";

/* __next_internal_action_entry_do_not_use__ {"f280782ec67a6b6ceb6d59573d5e237763c01f09":"getDataPatient"} */ __turbopack_esm__({
    "getDataPatient": ()=>getDataPatient
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/server-reference.js [app-rsc] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$app$2d$render$2f$encryption$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/node_modules/next/dist/server/app-render/encryption.js [app-rsc] (ecmascript)");
var __TURBOPACK__commonjs__external__crypto__ = __turbopack_external_require__("crypto", true);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$validate$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-validate.js [app-rsc] (ecmascript)");
"__TURBOPACK__ecmascript__hoisting__location__";
;
;
;
const algorithm = 'aes-256-cbc'; // Algoritmo de encriptación
const key = process.env.BASE_POBLACIONAL_ENCRYPT_KEY || '';
const iv = __TURBOPACK__commonjs__external__crypto__["default"].randomBytes(16); // Vector de inicialización
function encryptData(data) {
    // if (key.length !== 32) {
    //     throw new Error('Invalid key length. Key must be 32 bytes long for aes-256-cbc.');
    // }
    const cipher = __TURBOPACK__commonjs__external__crypto__["default"].createCipheriv(algorithm, Buffer.from(key), iv);
    let encrypted = cipher.update(JSON.stringify(data));
    encrypted = Buffer.concat([
        encrypted,
        cipher.final()
    ]);
    return iv.toString('hex') + ':' + encrypted.toString('hex');
}
function decryptData(token) {
    if (key.length !== 32) {
        throw new Error('Invalid key length. Key must be 32 bytes long for aes-256-cbc.');
    }
    const textParts = token.split(':');
    const iv = Buffer.from(textParts.shift(), 'hex');
    const encryptedText = Buffer.from(textParts.join(':'), 'hex');
    const decipher = __TURBOPACK__commonjs__external__crypto__["default"].createDecipheriv(algorithm, Buffer.from(key), iv);
    let decrypted = decipher.update(encryptedText);
    decrypted = Buffer.concat([
        decrypted,
        decipher.final()
    ]);
    return JSON.parse(decrypted.toString());
}
async function getDataPatient(documento) {
    const host = process.env.BASE_POBLACIONAL_URI || '';
    console.log('host:', host);
    const data = {
        documento: Number(documento),
        query: []
    };
    const token = encryptData(data);
    try {
        const res = await fetch(`${host}/api/v1/getBasicData`, {
            method: 'GET',
            headers: {
                'authorization': `Bearer ${process.env.BASE_POBLACIONAL_AUTH_TOKEN || ''}`,
                'data': token
            }
        });
        console.log('res:', res);
        if (res.status !== 200) {
            throw new Error('No se logró encontrar la información solicitada');
        }
        const json = await res.json();
        const encryptedData = json.data;
        const decryptedData = decryptData(encryptedData);
        return {
            failed: false,
            data: decryptedData
        };
    } catch (err) {
        return {
            failed: true,
            message: "No se logró encontrar la información solicitada"
        };
    }
}
;
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$validate$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["ensureServerEntryExports"])([
    getDataPatient
]);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$rsc$5d$__$28$ecmascript$29$__["registerServerReference"])("f280782ec67a6b6ceb6d59573d5e237763c01f09", getDataPatient);

})()),
"[project]/.next-internal/server/app/page/actions.js { ACTIONS_MODULE0 => \"[project]/src/server/login.ts [app-rsc] (ecmascript, action, ecmascript)\", ACTIONS_MODULE1 => \"[project]/src/utils/helpers.ts [app-rsc] (ecmascript, action, ecmascript)\", ACTIONS_MODULE2 => \"[project]/src/utils/mongo.ts [app-rsc] (ecmascript, action, ecmascript)\", ACTIONS_MODULE3 => \"[project]/src/utils/http.ts [app-rsc] (ecmascript, action, ecmascript)\" } [app-rsc] (ecmascript)": (function({ r: __turbopack_require__, f: __turbopack_module_context__, i: __turbopack_import__, s: __turbopack_esm__, v: __turbopack_export_value__, n: __turbopack_export_namespace__, c: __turbopack_cache__, M: __turbopack_modules__, l: __turbopack_load__, j: __turbopack_dynamic__, P: __turbopack_resolve_absolute_path__, U: __turbopack_relative_url__, R: __turbopack_resolve_module_id_path__, g: global, __dirname, x: __turbopack_external_require__, y: __turbopack_external_import__, m: module, e: exports, t: require }) { !function() {

__turbopack_export_value__({
    '08f302e750b321d0925fa0bc9f4a0bc2d504a6c6': (...args)=>Promise.resolve(__turbopack_require__("[project]/src/server/login.ts [app-rsc] (ecmascript, action, ecmascript)")).then((mod)=>(0, mod['ValidateCodeDB'])(...args)),
    '19e5c0dd5dd6703d358a7959cbc8b35b1fdef8c4': (...args)=>Promise.resolve(__turbopack_require__("[project]/src/utils/helpers.ts [app-rsc] (ecmascript, action, ecmascript)")).then((mod)=>(0, mod['encrypt'])(...args)),
    '1c4ce6e1548761242e0fc4080406954d09629907': (...args)=>Promise.resolve(__turbopack_require__("[project]/src/utils/mongo.ts [app-rsc] (ecmascript, action, ecmascript)")).then((mod)=>(0, mod['LoginUserDB'])(...args)),
    '21b92e784e69cc96106fa221a2c2a85c93c744ee': (...args)=>Promise.resolve(__turbopack_require__("[project]/src/utils/mongo.ts [app-rsc] (ecmascript, action, ecmascript)")).then((mod)=>(0, mod['getUserRegisterByMail'])(...args)),
    '2a4aa52ec04bad5bd7a7d951faf47f9e2a98e0ab': (...args)=>Promise.resolve(__turbopack_require__("[project]/src/utils/mongo.ts [app-rsc] (ecmascript, action, ecmascript)")).then((mod)=>(0, mod['getUserRegisterByDocumento'])(...args)),
    '2cbbb32563e51c2c38c64e184eb290cc223b643d': (...args)=>Promise.resolve(__turbopack_require__("[project]/src/server/login.ts [app-rsc] (ecmascript, action, ecmascript)")).then((mod)=>(0, mod['ResetRandomPassword'])(...args)),
    '3896fb9737893354ca9e9f73eacdb15a089d3690': (...args)=>Promise.resolve(__turbopack_require__("[project]/src/utils/helpers.ts [app-rsc] (ecmascript, action, ecmascript)")).then((mod)=>(0, mod['decrypt'])(...args)),
    '3de689509e1bc4152490c760ec9cdbe27c91e2ac': (...args)=>Promise.resolve(__turbopack_require__("[project]/src/utils/mongo.ts [app-rsc] (ecmascript, action, ecmascript)")).then((mod)=>(0, mod['GetTempCode'])(...args)),
    '56a8884c72c058ad262e0bb322a3dbf3b422438b': (...args)=>Promise.resolve(__turbopack_require__("[project]/src/utils/mongo.ts [app-rsc] (ecmascript, action, ecmascript)")).then((mod)=>(0, mod['setNewPasswordByDocumento'])(...args)),
    '6052572489830d6ea6a97726ab66a58ff3651447': (...args)=>Promise.resolve(__turbopack_require__("[project]/src/utils/helpers.ts [app-rsc] (ecmascript, action, ecmascript)")).then((mod)=>(0, mod['encryptALONE'])(...args)),
    '7117306d3bb95dc604709e25da694c71b882d471': (...args)=>Promise.resolve(__turbopack_require__("[project]/src/utils/helpers.ts [app-rsc] (ecmascript, action, ecmascript)")).then((mod)=>(0, mod['GenerateCode'])(...args)),
    '787acc2bd299c33697dbaa34943fc5c1db810b16': (...args)=>Promise.resolve(__turbopack_require__("[project]/src/utils/mongo.ts [app-rsc] (ecmascript, action, ecmascript)")).then((mod)=>(0, mod['SetNewPassword'])(...args)),
    '858904be9ee2459af8f4ab08246d2f8bc3b023c0': (...args)=>Promise.resolve(__turbopack_require__("[project]/src/utils/mongo.ts [app-rsc] (ecmascript, action, ecmascript)")).then((mod)=>(0, mod['getMailExists'])(...args)),
    '9ea85d00ae5d7c033b3cde1c1955b906c1b2cb29': (...args)=>Promise.resolve(__turbopack_require__("[project]/src/utils/mongo.ts [app-rsc] (ecmascript, action, ecmascript)")).then((mod)=>(0, mod['getUserExists'])(...args)),
    'b4332f6f58871d110c10aa9dc6088593a04593f3': (...args)=>Promise.resolve(__turbopack_require__("[project]/src/server/login.ts [app-rsc] (ecmascript, action, ecmascript)")).then((mod)=>(0, mod['ValidateCredentialsDB'])(...args)),
    'bb3970afdd6be7ab38da4019fe6adad6cf155b6b': (...args)=>Promise.resolve(__turbopack_require__("[project]/src/utils/mongo.ts [app-rsc] (ecmascript, action, ecmascript)")).then((mod)=>(0, mod['saveUserDB'])(...args)),
    'c6242bc9cf3ceffcdae35466461d0eef73f1c745': (...args)=>Promise.resolve(__turbopack_require__("[project]/src/server/login.ts [app-rsc] (ecmascript, action, ecmascript)")).then((mod)=>(0, mod['GenerateAndSendCode'])(...args)),
    'c7d345923671196f5950e89bd6745978b3cd83a1': (...args)=>Promise.resolve(__turbopack_require__("[project]/src/utils/mongo.ts [app-rsc] (ecmascript, action, ecmascript)")).then((mod)=>(0, mod['getDocumentoByEmail'])(...args)),
    'ccce0b7f68ddc897ec5092bc8257a234eb35766b': (...args)=>Promise.resolve(__turbopack_require__("[project]/src/utils/mongo.ts [app-rsc] (ecmascript, action, ecmascript)")).then((mod)=>(0, mod['InsertTempCode'])(...args)),
    'dc9d6386a27158e86c2b69f54bb698c2d0ae65f4': (...args)=>Promise.resolve(__turbopack_require__("[project]/src/utils/mongo.ts [app-rsc] (ecmascript, action, ecmascript)")).then((mod)=>(0, mod['getMailByDocumento'])(...args)),
    'f280782ec67a6b6ceb6d59573d5e237763c01f09': (...args)=>Promise.resolve(__turbopack_require__("[project]/src/utils/http.ts [app-rsc] (ecmascript, action, ecmascript)")).then((mod)=>(0, mod['getDataPatient'])(...args))
});

}.call(this) }),

};

//# sourceMappingURL=_336e8a._.js.map